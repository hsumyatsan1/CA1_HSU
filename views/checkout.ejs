<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Credit Card Payment</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/theme.css" rel="stylesheet">
</head>
<body>

<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">Supermarket</a>
  </div>
</nav>

<div class="container mt-4">
  <h2 class="mb-4">Credit Card Payment</h2>

  <% if (messages && messages.error && messages.error.length) { %>
    <div class="alert alert-danger">
      <% messages.error.forEach(msg => { %>
        <p><%= msg %></p>
      <% }); %>
    </div>
  <% } %>

  <div class="row g-4">
    <div class="col-md-6">
      <form method="POST" action="/payment">
        <input type="hidden" name="paymentMethod" value="credit-card">
        <div class="mb-3">
          <label class="form-label">Name on Card</label>
          <input type="text" name="cardName" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Card Number</label>
          <input type="text" name="cardNumber" class="form-control" maxlength="19" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Expiry Date</label>
          <input type="month" name="expiryDate" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">CVC</label>
          <input type="password" name="cardPin" class="form-control" maxlength="6" required>
        </div>
        <button type="submit" class="btn btn-success">Make Payment</button>
        <a href="/payment" class="btn btn-secondary ms-2">Back</a>
      </form>
    </div>

    <div class="col-md-6">
      <h5>Order Summary</h5>
      <ul class="list-group mb-3">
        <% if (cart && cart.length) { %>
          <% cart.forEach(item => { %>
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <strong><%= item.productName || item.name %></strong>
                <div class="text-muted">Qty: <%= item.quantity || item.qty %></div>
              </div>
              <span>$<%= (parseFloat(item.price) * parseInt(item.quantity || item.qty, 10)).toFixed(2) %></span>
            </li>
          <% }) %>
        <% } else { %>
          <li class="list-group-item">No order data available.</li>
        <% } %>
      </ul>
      <div class="card">
        <div class="card-body">
          <h5>Total: <span class="text-success">$<%= parseFloat(total || 0).toFixed(2) %></span></h5>
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
