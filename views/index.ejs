<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Supermarket - The Online Grocery Store</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    .navbar { box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .hero { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 80px 20px; text-align: center; position: relative; overflow: hidden; }
    .hero h1 { font-size: 3rem; font-weight: 700; color: #1a1a1a; margin-bottom: 10px; }
    .hero .tagline { font-size: 1.1rem; color: #666; margin-bottom: 30px; }
    .hero .badge-discount { position: absolute; top: 40px; right: 40px; background: #4169e1; color: white; padding: 8px 16px; border-radius: 50px; font-weight: 700; }
    .hero-image { max-width: 100%; height: auto; margin-top: 30px; }
    .shop-btn { background: #6ba368; color: white; padding: 12px 30px; border: none; border-radius: 6px; font-weight: 600; text-decoration: none; display: inline-block; transition: 0.3s; }
    .shop-btn:hover { background: #5a9257; color: white; }
    .category-section { padding: 60px 20px; background: #fafafa; }
    .category-section h3 { text-align: center; margin-bottom: 40px; font-weight: 700; color: #666; }
    .category-card { background: white; border-radius: 12px; padding: 30px; text-align: center; cursor: pointer; transition: 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .category-card:hover { transform: translateY(-8px); box-shadow: 0 8px 24px rgba(0,0,0,0.12); }
    .category-card img { max-width: 100%; height: 140px; object-fit: contain; margin-bottom: 15px; }
    .category-card h5 { font-weight: 600; color: #1a1a1a; }
    .products-section { padding: 60px 20px; }
    .products-section h2 { margin-bottom: 40px; font-weight: 700; }
    .product-card { border: none; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); transition: 0.3s; overflow: hidden; }
    .product-card:hover { box-shadow: 0 8px 24px rgba(0,0,0,0.15); }
    .product-card img { height: 180px; object-fit: cover; }
    .product-card .card-body { padding: 16px; }
    .product-card .card-title { font-weight: 600; color: #1a1a1a; }
    .product-card .price { font-size: 1.2rem; color: #4169e1; font-weight: 700; margin: 10px 0; }
    .product-card .btn { border-radius: 6px; width: 100%; }
  </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-white">
  <div class="container">
    <a class="navbar-brand fw-bold" href="/">ðŸ›’ Supermarket</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="/contact">Contact</a></li>
        <li class="nav-item">
          <form class="d-flex" action="/search" method="GET">
            <input class="form-control form-control-sm me-2" name="q" placeholder="Search items...">
            <button class="btn btn-outline-primary btn-sm" type="submit">Search</button>
          </form>
        </li>
        <% if (!user) { %>
          <li class="nav-item"><a class="nav-link" href="/register">Sign up</a></li>
          <li class="nav-item"><a class="nav-link" href="/login">Log in</a></li>
        <% } else if (user.role === 'admin') { %>
          <li class="nav-item"><a class="nav-link" href="/inventory">Inventory</a></li>
          <li class="nav-item"><a class="nav-link" href="/users">Users</a></li>
          <li class="nav-item"><a class="nav-link" href="/feedback/all">Feedback</a></li>
          <li class="nav-item"><a class="nav-link" href="/payments">Payments</a></li>
          <li class="nav-item"><a class="nav-link" href="/logout">Log out</a></li>
        <% } else { %>
          <li class="nav-item"><a class="nav-link" href="/shopping">Shop</a></li>
          <li class="nav-item"><a class="nav-link" href="/cart">Cart</a></li>
          <li class="nav-item"><a class="nav-link" href="/logout">Log out</a></li>
        <% } %>
      </ul>
    </div>
  </div>
</nav>

<!-- Hero Section -->
<div class="hero">
  <div class="badge-discount">20% OFF</div>
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-6 text-start">
        <small class="text-muted">Today's Special</small>
        <h1>The Online<br>Grocery Store</h1>
        <p class="tagline">Fresh produce delivered to your doorstep</p>
        <% if (!user) { %>
          <a href="/login" class="shop-btn">Shop Now</a>
        <% } else { %>
          <a href="/shopping" class="shop-btn">Shop Now</a>
        <% } %>
      </div>
      <div class="col-lg-6">
        <img src="https://img.freepik.com/premium-vector/cartoon-illustration-family-shopping-supermarket-grocery-store_723224-3030.jpg?w=2000" alt="Fresh Produce" class="hero-image">
      </div>
    </div>
  </div>
</div>


<!-- Products Section -->
<div class="products-section">
  <div class="container">
    <h2>Featured Products</h2>
    <% if (messages && messages.error && messages.error.length) { %>
      <div class="alert alert-danger">
        <% messages.error.forEach(msg => { %>
          <p><%= msg %></p>
        <% }); %>
      </div>
    <% } %>

    <% if (messages && messages.success && messages.success.length) { %>
      <div class="alert alert-success">
        <% messages.success.forEach(msg => { %>
          <p><%= msg %></p>
        <% }); %>
      </div>
    <% } %>
    <div class="row g-3">
      <% if (products && products.length) { %>
        <% products.slice(0, 6).forEach(p => { %>
          <div class="col-md-4 col-lg-3">
            <div class="card product-card h-100">
              <% if (p.image) { %>
                <img src="/images/<%= p.image %>" class="card-img-top" alt="<%= p.productName %>">
              <% } else { %>
                <div class="card-img-top bg-light d-flex align-items-center justify-content-center" style="height:180px">No Image</div>
              <% } %>
              <div class="card-body d-flex flex-column">
                <h5 class="card-title"><%= p.productName %></h5>
                <p class="price">$<%= parseFloat(p.price||0).toFixed(2) %></p>
                <p class="text-muted flex-grow-1">Stock: <%= p.quantity || 0 %></p>
                <% if (user) { %>
                  <form action="/add-to-cart/<%= p.id %>" method="POST" class="d-flex gap-2">
                    <select name="qty" class="form-select form-select-sm" style="width:80px;">
                      <% for (let i=1;i<=Math.min(10, (p.quantity||0)); i++) { %>
                        <option value="<%= i %>"><%= i %></option>
                      <% } %>
                    </select>
                    <button class="btn btn-primary btn-sm flex-grow-1" <%= (p.quantity||0) <= 0 ? 'disabled' : '' %>>Add</button>
                  </form>
                <% } else { %>
                  <a href="/login" class="btn btn-outline-primary btn-sm">Log in to buy</a>
                <% } %>
              </div>
            </div>
          </div>
        <% }) %>
      <% } else { %>
        <p>No products available</p>
      <% } %>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
